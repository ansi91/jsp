<?xml version="1.0" encoding="UTF-8" ?> 
<!DOCTYPE mapper
 PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
 "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="orm.mybatis.mapper.boardMapper">

	<select id="boardList" parameterType="map" resultType="map">
		SELECT * FROM board_master_t bm, board_sub_t bs
		where bm.bm_no = bs.bm_no(+)
	</select>
					
	<insert id="boardMINS" parameterType="map">
		INSERT INTO board_master_t(bm_no,bm_title,bm_group,bm_email) VALUES(
																											#{bm_no}
																											,#{bm_group}
																											,#{bm_title}
																											,#{bm_email})
	</insert>
	<insert id="boardSINS" parameterType="map">
		INSERT INTO board_sub_t(bm_no) VALUES(#{bm_no})
	</insert>
	<update id="bmStepUpdate" parameterType="map">
		UPDATE board_master_t
		SET bm_step = b_step+1
		WHERE bm_group =#{bm_group}
		AND bm_step > #{bm_step}
	</update>
	
	<!--글목록에서 제목을 클릭했을때 조회수 1씩 증가 시키는 sql문  -->
	<update id="hitCount" parameterType="int">
		UPDATE board_master_t
		SET bm_hit = bm_hit+1
		WHERE bm_no=#{value}
	</update>
	<!--그룹번호 채번하기  -->
	<select id="getBmGroup" parameterType="map" resultType="int">
		SELECT NVL((SELECT /*+index_desc(board_master_t ibm_group)*/
		 bm_group FROM board_master_t WHERE rownum=1 AND bm_group>0),0)+1 bm_group
		FROM dual
	</select>
	<!--글번호 채번하기  -->
	<select id="getBmNo">
		SELECT NVL((SELECT /*+index_desc(board_master_t SCOTT.BM_NO_PK)*/ bm_group
		FROM board_master_t WHERE rownum=1 AND bm_group>0),0)+1 bm_no
		FROM dual
	</select>
</mapper>